window.tracking={trackers:[GoogleAnalyticsTracker={event:function(e){_gaq.push(["_trackEvent",e.category,e.action,e.label,e.value,e.noninteraction||!1])},page:function(e){_gaq.push(["_trackPageview",e.url])},transaction:function(e){var t={id:$.generateHash(32),products:[],designer:"",total:0,tax:0,shipping:0,geo:{city:"N/A",state:"N/A",country:"N/A"}},o=$.extend(t,e);_gaq.push(["_addTrans",o.id,o.designer,o.total,o.tax,o.shipping,o.geo.city,o.geo.state,o.geo.country]),e.products.forEach(function(e){_gaq.push(["_addItem",o.id,e.id,e.name,e.type,e.price,e.quantity||1])}),_gaq.push(["_trackTrans"])}},FacebookPixelTracker={event:function(e){fbq("trackCustom",e.category,{action:e.action,label:e.label,value:e.value})},page:function(e){fbq("track","PageView",{url:e.url})},transaction:function(e){fbq("track","Purchase",{contents:e.products,value:e.total,currency:"USD"})}}],track:function(t,o){o?this.trackers.forEach(function(e){"function"==typeof e[t]&&e[t](o)}):console.warn("No tracking data provided.")}},$(function(){$.notify=function(e){var t={id:$.generateHash(8),type:"secondary",title:"",timeout:3500},o=$.extend(t,e);if(""!==o.title){var a=templates.render("partials/_notify.html",o);$("#notify").length||$("<div/>",{id:"notify"}).appendTo("body"),$(a).prependTo("#notify").hide().fadeIn(),setTimeout(function(){$("#notify-"+o.id).fadeOut(function(){$(this).remove()})},o.timeout)}}}),$(function(){$.generateHash=function(e){var t="",o="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789";e=e||8;for(var a=0;a<e;a++)t+=o.charAt(Math.floor(Math.random()*o.length));return t}}),window.filters={priceformat:function(e,t){return t=t||"USD",currency_symbols={USD:"$",EUR:"&euro;"},symbol=currency_symbols[t]||t,symbol+e.toFixed(2)},filesizeformat:function(e,t){var n=t?1024:1e3,i=parseFloat(e);return 1===i?"1 Byte":i<n?i+" Bytes":["Bytes",t?"KiB":"kB",t?"MiB":"MB",t?"GiB":"GB",t?"TiB":"TB",t?"PiB":"PB",t?"EiB":"EB",t?"ZiB":"ZB",t?"YiB":"YB"].reduce(function(e,t,o){var a=Math.pow(n,o);return a<=i?(i/a).toFixed(1)+" "+t:e})},intcomma:function(e){return e.toString().replace(/\B(?=(\d{3})+(?!\d))/g,",")},sum:function(e,t){var o=0;return e.forEach(function(e){o+=e[t.attribute]}),o},title:function(e){return e.charAt(0).toUpperCase()+e.slice(1)}},$(function(){window.templates=new nunjucks.Environment,$.each(window.filters,function(e,t){templates.addFilter(e,t,!0)})}),$(function(){$.ajaxSetup({beforeSend:function(e,t){var o,a,n,i;i=t.type,/^(GET|HEAD|OPTIONS|TRACE)$/i.test(i)||(o=t.url,a="//"+document.location.host,n=document.location.protocol+a,o!=n&&o.slice(0,n.length+1)!=n+"/"&&o!=a&&o.slice(0,a.length+1)!=a+"/"&&/^(\/\/|http:|https:).*/.test(o))||e.setRequestHeader("X-CSRFToken",Cookies.get("csrftoken"))}}),$(document).ajaxError(function(e,t,o,a){Raven.captureMessage(a||t.statusText,{extra:{type:o.type,url:o.url,data:o.data,status:t.status,error:a||t.statusText,response:t.responseText}})})}),$(function(){if($.extend(FormSerializer.patterns,{validate:/^[a-z][a-z0-9_-]*(?:\[(?:\d*|[a-z0-9_-]+)\])*$/i,key:/[a-z0-9_-]+|(?=\[\])/gi,named:/^[a-z0-9_-]+$/i}),$(document).on("click",'[data-toggle="toggle"]',function(e){e.preventDefault();var t=$(this),o=t.data("target")||t.attr("href");$(o).toggleClass("d-none")}),$('[data-toggle="tooltip"]').tooltip(),$('[data-toggle="popover"]').popover(),$(document).on("mouseenter",".license-helper",function(){$(this).popover({content:function(){return $(this).siblings(".license-content").html()},html:!0,sanitize:!1,trigger:"hover",placement:"bottom"}).popover("show")}),$(".search-form .flexdatalist").on("show:flexdatalist.results",function(){var t=$(this).siblings(".flexdatalist-alias"),e="#"+t.attr("id")+"-results";t.addClass("with-results"),$(document).one("DOMNodeRemoved",e,function(e){t.removeClass("with-results")})}),$(".search-form .flexdatalist").on("select:flexdatalist",function(){$(this).parents("form").submit()}),$(".search-form .flexdatalist-alias").on("keydown",function(e){13==e.keyCode&&$(this).parents("form").submit()}),$(".flexdatalist").parents("form").on("submit",function(){$(this).find(".flexdatalist-alias").removeAttr("name")}),$(document).on("click","[data-confirm]",function(e){var t=confirm($(this).data("confirm"));return t||e.stopImmediatePropagation(),t}),$(document).on("click",'[data-toggle="tooltip"]',function(){$(this).tooltip("hide")}),$(document).on("shown.bs.collapse",".collapse",function(){$(this).find("[autofocus]").trigger("focus")}),$(".background-picker").on("click","a",function(e){e.preventDefault();var t=$(this),o=t.parents(".background-picker"),a=t.data("value");o.find(".active").removeClass("active"),t.addClass("active"),$("body").removeClass("preview-white preview-black preview-gray preview-transparent").addClass("preview-"+a),Cookies.set("preview-color",a)}),$(document).on("click",'[data-requires="user"]',function(e){if("undefined"==typeof USER){e.preventDefault(),e.stopImmediatePropagation(),renderModal("signup/_modal");var t=$(this);$("body").on("form.submit.success","#login-form, #signup-form",function(e){t.is("a")&&"#"!==t.attr("href")&&(e.stopImmediatePropagation(),location.href=t.attr("href"))})}}),$(document).on("click",'[href="/user/logout"]',function(){Intercom("shutdown")}),Cookies("flash-message")&&($.notify(Cookies.getJSON("flash-message")),Cookies.remove("flash-message")),$(document).on("click","[data-tracking]",function(){var e=$(this).data("tracking").split("|");e.length<2||tracking.track("event",{category:e[0],action:e[1],label:e[2]||null,value:e[3]||null})}),"true"==$.url().param("trackevent")){var e=$.url().param();tracking.track("event",{category:e.event_category,action:e.event_action,label:e.event_label,value:e.event_value})}$.fn.hotkey=function(){return this.each(function(){var e=$(this),t=e.data("hotkey");$(document).on("keyup",null,String(t),function(){e.trigger("focus").trigger("click"),"a"===e.prop("tagName").toLowerCase()&&(window.location=e.attr("href"))})})},$("[data-hotkey]").hotkey()}),$(function(){$.fn.loading=function(e,t){if($(".loading-overlay").remove(),e){var o=$.extend({animation:!0,title:"Loading, please wait..."},t),a=templates.render("partials/_loading.html",o);this.append(a),$(".tooltip").tooltip("hide")}}}),$(function(){$(document).on("keydown","#login-form",function(e){13==e.keyCode&&$(this).submit()}),$(document).on("form.submit.success","#login-form",function(e){tracking.track("event",{category:"User",action:"Log in",label:"Logged in successfully"})}),$(document).on("form.submit.error","#login-form",function(e,t){var o=$(this);tracking.track("event",{category:"User",action:"Log in",label:"Error"}),o.parents(".modal-content").loading(!1),t.errors["g-recaptcha-response"]&&($("#recaptcha-script").length||$("<script/>",{id:"recaptcha-script",src:"https://www.google.com/recaptcha/api.js"}).appendTo("head"),o.find("#recaptcha-holder").removeClass("d-none"),e.stopImmediatePropagation())}),$(document).on("form.submit.success","#signup-form",function(e){tracking.track("event",{category:"User",action:"Sign up",label:"Signed up successfully"})}),$(document).on("form.submit.error","#signup-form",function(e,t){$(this).parents(".modal-content").loading(!1),tracking.track("event",{category:"User",action:"Sign up",label:"Error"})}),$(document).on("click",'[data-toggle="facebook"]',function(){FB.login(function(e){if(e.authResponse){var o={access_token:e.authResponse.accessToken};FB.api("/me",{fields:"first_name, last_name, email"},function(e){$.extend(o,e),$.ajax({url:"/user/ajax/login/facebook",method:"POST",data:o,success:function(e){tracking.track("event",{category:"User",action:"Connect with Facebook",label:"Successful"}),location.reload()},error:function(e){var t=e.responseJSON;"missing_user_data"==t.code?(tracking.track("event",{category:"User",action:"Connect with Facebook",label:"Require data"}),renderModal("signup/_missing-details",$.extend(t.additional_data,o))):tracking.track("event",{category:"User",action:"Connect with Facebook",label:"Failed"})}})})}else tracking.track("event",{category:"User",action:"Connect with Facebook",label:"Cancelled"})},{scope:"public_profile,email"})})}),$(function(){$(document).on("submit","form.needs-validation",function(e){var t=e.currentTarget,o=t.checkValidity();$(t).addClass("was-validated"),$(t).removeClass("server-validated"),$(t).find(".invalid-feedback.added").remove(),o||(e.preventDefault(),e.stopImmediatePropagation())}),$(document).on("click",'[data-toggle="submit"]',function(){var e=$(this);$(e.data("target")).submit()}),$(document).on("submit",'form[data-submit="ajax"]',function(e){e.preventDefault();var t=$(this);$.ajax({url:t.attr("action"),method:t.attr("method"),data:t.serializeObject(),success:function(e){t.trigger("form.submit.success",e)},error:function(e){t.trigger("form.submit.error",e.responseJSON)},complete:function(e){t.trigger("form.submit.complete",e.responseJSON)}})}),$(document).on("form.submit.success",'form[data-submit="ajax"]',function(e){var t=$(this),o={type:"success",title:t.data("success-title"),description:t.data("success-description")};switch(t.data("success")){case"reload":Cookies.set("flash-message",o),location.reload();break;case"redirect":Cookies.set("flash-message",o),location.replace(t.data("success-url"));break;default:$.notify(o)}}),$(document).on("form.submit.error",'form[data-submit="ajax"]',function(e,t){var a=$(this),o=a.data("error-title")||"Something went wrong";"error"==t.status&&(t.message&&(o=t.message),t.errors&&(a.removeClass("was-validated").addClass("server-validated"),$.each(t.errors,function(e,t){var o=a.find("[name="+e+"]");o.parent().find(".invalid-feedback.added").remove(),o.addClass("is-invalid").after('<div class="invalid-feedback added">'+t+"</div>")}))),$.notify({type:"danger",title:o,description:a.data("error-description")})})}),$(function(){$(document).on("click","[data-remote]",function(e){e.preventDefault();var t=$(this),o=t.data(),a=$("body");t.parents(".modal-content").length&&(a=t.parents(".modal-content"));var n=setTimeout(function(){a.loading(!0,{title:o.loadingTitle})},200);$.ajax({url:o.remote,method:o.method||"GET",data:_.omit(o,["modal","toggle","remote","method","confirm","loadingTitle","success","successTitle","error","errorTitle","bs.tooltip"]),success:function(e){t.trigger("remote.call.success",e)},error:function(e){t.trigger("remote.call.error",e)},complete:function(){clearTimeout(n),a.loading(!1)}})}),$(document).on("remote.call.success","[data-remote]",function(){var e=$(this).data(),t={type:"success",title:e.successTitle,description:e.successDescription};e.success&&("dismiss"==e.success?$.notify(t):(Cookies.set("flash-message",t),"reload"==e.success?location.reload():location.replace(e.success)))}),$(document).on("remote.call.error","[data-remote]",function(e,t){var o=$(this),a=(o.data(),o.data("error-title")||"Failed loading remote data");t.responseJSON&&(a=t.responseJSON.message||a),$.notify({type:"danger",title:a}),$(this).parents().has(".loading-overlay").loading(!1)})}),$(function(){$(".navbar").each(function(){var e=$(this).offset().top,t=$('[data-toggle="navigation-sticky"]');t.length&&(e=t.offset().top+t.outerHeight(),$("body").addClass("nav-fade")),$(window).on("load scroll",function(){$("body").toggleClass("nav-fixed",$(window).scrollTop()>=e)})})}),$(function(){$(document).on("shown.bs.modal",".modal",function(){var e=$(this);e.find("[autofocus]").trigger("focus"),e.find('[data-toggle="tooltip"]').tooltip(),e.find('[data-toggle="popover"]').popover(),e.find(".flexdatalist").flexdatalist(),e.find("input#cc-number").payment("formatCardNumber"),e.find("input#cc-expiry").payment("formatCardExpiry")}),$(document).on("shown.bs.modal",".modal",function(){var e=$(this),t=e.find(".modal-title").text();tracking.track("page",{url:"/modal/"+t}),e.on("click",'[data-action="confirm"]',function(){tracking.track("event",{category:"Modal",action:t,label:"Confirm"})}),e.on("click",'[data-dismiss="modal"]',function(){tracking.track("event",{category:"Modal",action:t,label:"Cancel"})})}),$(document).on("hidden.bs.modal",".modal.rendered",function(){$(this).remove()}),$(document).on("submit",'.modal [data-submit="ajax"]',function(e){var t=$(this);t.parents(".modal-content").loading(!0,{title:t.data("loading-title"),description:t.data("loading-description")})}),$(document).on("form.submit.error",'.modal [data-submit="ajax"]',function(e){$(this).parents(".modal-content").loading(!1)}),$(document).on("form.submit.complete",'.modal [data-submit="ajax"]',function(){"reload"!=$(this).data().success&&$(this).find(".modal-content").loading(!1)}),$(document).on("form.submit.success remote.call.success",'.modal [data-success="dismiss"]',function(){$(this).parents(".modal").modal("hide")}),$(document).on("click","[data-modal]",function(e){e.preventDefault();var o=$(this).data();o.remote?$(this).one("remote.call.success",function(e,t){renderModal(o.modal,$.extend({},o,t))}):renderModal(o.modal,o)}),window.renderModal=function(e,t){var o=templates.render(e+".html",t);$(".modal").modal("hide"),$(o).modal("show")}}),$(function(){$(document).on("remote.call.success","[data-cart]",function(e,t){if(e.preventDefault(),t){var o=$('[data-counter="cart_items"]'),a=0===t.cart.cart_items.length;o.text(t.cart.cart_items.length),o.parents(".nav-item").toggleClass("d-none",a),a&&$("#cart-preview-dropdown").collapse("hide");var n=templates.render("cart/_dropdown.html",t);$("#cart-preview-dropdown").html(n),0===$(this).parents(".cart-preview").length&&$("#cart-preview-dropdown").collapse("show"),$(document).trigger("cart.updated",t)}}),$("#cart-preview-dropdown").on("show.bs.collapse",function(){0<$(this).find(".loading").length&&$.ajax({url:"/commerce/ajax/cart/",success:function(e){var t=templates.render("cart/_dropdown.html",e);$("#cart-preview-dropdown").html(t)},error:function(e){$("#cart-preview-dropdown").collapse("hide"),$.notify({type:"danger",title:"Something went wrong",description:"Please try again."})}}),tracking.track("page",{url:"commerce/cart"}),$(document).one("click",function(e){0===$(e.target).parents("#cart-preview-dropdown").length&&$("#cart-preview-dropdown").collapse("hide")}),$(".navbar-nav .dropdown").one("show.bs.dropdown",function(){$("#cart-preview-dropdown").collapse("hide")})})}),$(function(){$(document).on("click",'.icon-preview [data-toggle="all-sizes"]',function(e){e.preventDefault(),e.stopImmediatePropagation(),$(this).parents(".dropdown-menu").find(".d-none").removeClass("d-none"),$(this).remove()}),$(document).on("mouseleave",".icon-preview",function(){$(this).find(".dropdown-menu.show").removeClass("show")}),$(document).on("click",'[data-action="base64"]',function(e){e.preventDefault();var t=$(this),o=t.attr("href"),a=t.data("asset-format");$("body").loading(!0);var n=function(e){renderModal("icons/_base64",{format:a.toUpperCase(),datauri:e}),$("body").loading(!1)};if("svg"==a)$.ajax({url:o,dataType:"text",success:function(e){n("data:image/svg+xml;base64,"+Base64.encode(e))}});else{var i=new Image;i.src=o,i.onload=function(){var e=document.createElement("canvas");e.width=this.width,e.height=this.height,e.getContext("2d").drawImage(this,0,0),n(e.toDataURL("image/"+a))}}}),$(document).on("click",'[data-action="editor"]',function(){Intercom("trackEvent","icon-opened-in-editor")}),$(document).on("submit","#flag-icon-form",function(){tracking.track("event",{category:"Icons",action:"Flag",label:"Icon flagged"}),Intercom("trackEvent","icon-reported")})}),$(function(){$(document).on("click",'[data-action="download"]',function(){var o=$(this),a=o.data();return $.ajax({url:"/"+a.assetType+"s/"+a.assetId+"/check-download/"+a.assetFormat,success:function(e){if($.notify({type:"success",title:"Downloading "+a.assetType,description:"Remember to check license information before using downloaded icons."}),location.href=o.attr("href"),"undefined"!=typeof USER&&USER.pro_subscription_usable){var t=e.is_premium;!(-1<e.pro_downloaded_icon_ids_in_period.indexOf(a.assetId))&&t&&$('[data-counter="pro_downloads"]').text(function(){return parseInt($(this).text())+1})}tracking.track("event",{category:filters.title(a.assetType),action:"Download",label:a.assetFormat.toLowerCase()}),Intercom("trackEvent","icon-download")},error:function(e){var t="";e.responseJSON&&e.responseJSON.code&&(t=e.responseJSON.code),"download_limit_reached"==t?(renderModal("limiter/_limit-reached",e.responseJSON),tracking.track("event",{category:"User",action:"Premium download limit",label:"Limit reached"})):"registration_required"==t?(renderModal("limiter/_signup-prompt"),tracking.track("event",{category:"User",action:"Free download limit",label:"Limit reached"})):"pro_subscription_required"==t?(renderModal("limiter/_subscription-required"),tracking.track("event",{category:"User",action:"Pro subscription required",label:a.assetFormat})):$.notify({type:"danger",title:"Something went wrong",description:"Sorry, but it seems like something went wrong while trying to get the icon for you. Please try again or reload the page."})}}),!1})}),$(function(){$("#prepayment-form").on("change",'[name="predefined"]',function(){var e=$(this),t=e.val(),o=e.parents("form"),a=$("#custom-amount");""===t?a.collapse("show"):a.collapse("hide"),o.removeClass("was-validated"),o.find('input[name="amount"]').val(t)}),$("#prepayment-form").on("submit",function(){var e=$(this),t=e.find('[name="amount"]'),o=parseFloat(t.val()).toFixed(2),a=100*o;e.find('[name="amount_cents"]').val(a),tracking.track("event",{category:"Commerce",action:"Make prepayment",label:"Amount",value:o})})});